<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd">
			
<mapper namespace="bBoard">

 	<resultMap type="model.domain.Bboard" id="bBoardMap">
		<result property="bNo" column="b_no"/>
		<result property="bUserId" column="b_user_id"/>
		<result property="bTitle" column="b_title"/>
		<result property="bBody" column="b_body"/>
		<result property="bSecret" column="b_secret"/>
		<result property="bDate" column="b_date"/>
		<result property="bCount" column="b_count"/>
		<result property="bFilePath" column="b_file_path"/>
	</resultMap>

	<!-- B게시판 전체조회 -->
 	<select id="bList" resultMap="bBoardMap">
		select * from B_BOARD order by b_no
	</select>

	<!-- B게시판 등록 -->
 	<insert id="insertB" parameterType="bBoard">
		insert into B_BOARD (b_user_id, b_title, b_body, b_date, b_secret, b_file_path)
		values (#{bUserId}, #{bTitle}, #{bBody}, SYSDATE(), #{bSecret}, #{bFilePath})
	</insert>
	
	<!-- B게시판 수정 -->	
 	<update id="updateB" parameterType="bBoard" >
		update B_BOARD set b_title = #{bTitle}, b_body = #{bBody}, b_secret = #{bSecret}, b_date = SYSDATE(), b_file_path = #{bFilePath} where b_no = #{bNo}
	</update>
	
	<!-- B게시판 삭제 -->
 	<delete id="deleteB" parameterType="int">
		delete from B_BOARD where b_no = #{bNo}
	</delete>
	
	<!-- B게시판 상세조회 -->
 	<select id="bDetail" parameterType="bBoard" resultMap="bBoardMap">
		select * from B_BOARD where b_no = #{bNo}
	</select>
	
	<!-- B게시판 조회수 증가 -->
 	<update id="updateBCount" parameterType="bBoard">
		update B_BOARD set b_count = b_count+1 where b_no = #{bNo}
	</update>
	
	<!-- B게시판 새 글 등록시 글 번호 가져오기 -->
 	<select id="bNoGet" resultType="int">
		select b_no+1 from B_BOARD
	</select>

	<!-- B게시판 최근 사진 미리보기 조회 -->
	<select id="preBBoard" parameterType="bBoard" resultMap="bBoardMap">
		SELECT B_TITLE, B_BODY, B_DATE, B_FILE_PATH FROM B_BOARD WHERE B_NO = #{bNo}
	</select>
	
	<!-- 메인화면에 보여질 게시글 번호 가져오기 -->
	<select id="getMax" resultType="int">
		SELECT MAX(B_NO) AS B_NO FROM B_BOARD WHERE B_SECRET = 'N'
	</select>
</mapper>